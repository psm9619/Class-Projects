print(a)
list[i] <- a
temp2 <- trim(str_sub(temp, index[1], -1))
r(temp2, list)
}
}
r (tmp, rep)
append (a,d)
a <- c(1,2,3)
d <- 4
append (a,d)
c(a,d)
a
append(a,d)
c(a,d)
append(a,d)
list.append(a,d)
library(rvest)
library(stringr)
library(dplyr)
rep <- c()
r <- function (temp, list) {
for (i in 1:3) {
index <- str_locate (temp, "\r")
a <- str_sub(temp, 1, index[1]-1)
# append (list, a)
temp2 <- trim(str_sub(temp, index[1], -1))
r(temp2, list)
}
}
r (tmp, rep)
r (tmp, rep)
r2 (temp, c())
r2 <- function (temp, list) {
index <- str_locate (temp, "\r")
a <- str_sub(temp, 1, index[1]-1)
append (list, a)
}
r2 (temp, c())
r2 (tmp, c())
list <- c(1:3)
rep <- c()
r <- function (temp) {
list <- c(1:3)
for (i in 1:3) {
index <- str_locate (temp, "\r")
a <- str_sub(temp, 1, index[1]-1)
append (list, a)
temp2 <- trim(str_sub(temp, index[1], -1))
r(temp2)
return (list)
}
}
r (tmp)
return (a)
r2 <- function (temp) {
index <- str_locate (temp, "\r")
a <- str_sub(temp, 1, index[1]-1)
return (a)
}
r2 (tmp, c())
r2 (tmp)
result <- c()
result <- data.frame(c(),c(),c())
index <- str_locate (temp, "\r")
a <- str_sub(temp, 1, index[1]-1)
index <- str_locate (tmp, "\r")
a <- str_sub(tmp, 1, index[1]-1)
result <-a
result
result <- data.frame(c(),c(),c())
result <- data.frame(c(),c(),c()) ; result
result <- data.frame(c(),c(),c()) ; result
index <- str_locate (tmp, "\r")
a <- str_sub(tmp, 1, index[1]-1)
result <-a
for (i in 2:3) {
tmp <- trim(str_sub(tmp, index[1], -1))
r2 (tmp)
}
for (i in 2:3) {
tmp <- trim(str_sub(tmp, index[1], -1))
result <- r2 (tmp)
}
result
(time <- c(time, str_sub(tmp, 1, idx[1]-1)))
library(rvest)
library(stringr)
library(dplyr)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
rm(list=ls())
url_base <- 'https://movie.naver.com'
start_url <- '/movie/bi/mi/point.nhn?code='
code <- '176040#tab'
(url <- paste0(url_base, start_url, code, encoding="euc-kr"))
html <- read_html(url)
(html %>%
html_node('iframe.ifr') %>%
html_attr('src') -> url2)
ifr_url <- paste0(url_base, url2)
html2 <- read_html(ifr_url)
html2 %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
score <- c()  ; review <- c()  ; writer <- c()  ;  time <- c()
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, idx[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, idx[1]-1)))
tmp <- trim(str_sub(tmp, idx[1], -1))
idx <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, idx[1]-1)))
}
review = data.frame(score=score, review=review, writer=writer, time=time)
review
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
library(rvest)
library(stringr)
library(dplyr)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
rm(list=ls())
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
url_base <- 'https://movie.naver.com'
start_url <- '/movie/bi/mi/point.nhn?code='
code <- '176040#tab'
(url <- paste0(url_base, start_url, code, encoding="euc-kr"))
html <- read_html(url)
(html %>%
html_node('iframe.ifr') %>%
html_attr('src') -> url2)
ifr_url <- paste0(url_base, url2)
html2 <- read_html(ifr_url)
html2 %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
score <- c()  ; review <- c()  ; writer <- c()  ;  time <- c()
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, idx[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, idx[1]-1)))
tmp <- trim(str_sub(tmp, idx[1], -1))
idx <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, idx[1]-1)))
}
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, idx[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, idx[1]-1)))
tmp <- trim(str_sub(tmp, idx[1], -1))
index <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, idx[1]-1)))
}
(time <- c(time, str_sub(tmp, 1, index[1]-1)))
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, idx[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, idx[1], -1))
index <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, index[1]-1)))
}
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, idx[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, idx[1], -1))
index <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, index[1]-1)))
}
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, index[1]-1)))
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, index[1]-1)))
}
review = data.frame(score=score, review=review, writer=writer, time=time)
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, index[1]-1)))
print(score)
print(review)
print(writer)
print(time)
}
score <- c()  ; review <- c()  ; writer <- c()  ;  time <- c()
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, index[1]-1)))
print(score)
print(review)
print(writer)
print(time)
}
review = data.frame(score=score, review=review, writer=writer, time=time)
review
ifr_url
html2 %>%
html_node("page")
html2 %>%
html_node("#page")
html2 %>%
html_node("#page") %>%
html_text()
html2 %>%
html_node("#page") %>%
html_attr("value")
ifr_url
url <- paste0 (ifr_url, 'page=', page[1])
page <- c(1:11)
url <- paste0 (ifr_url, 'page=', page[1])
url
ifr_url
page <- c(1:11)
url <- paste0 (ifr_url, '&page=', page[1])
url
tot_review <- data.frame()
for (pg in 1:11) {
url <- paste0 (ifr_url, 'page=', page[pg])
html2 <- read_html(url) %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
score <- c()  ; review <- c()  ; writer <- c()  ;  time <- c()
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, index[1]-1)))
print(score)
print(review)
print(writer)
print(time)
}
review = data.frame(score=score, review=review, writer=writer, time=time)
tot_review <- rbind.data.frame(tot_review, review)
}
tot_review <- data.frame()
for (pg in 1:11) {
url <- paste0 (ifr_url, 'page=', page[pg])
html2 <- read_html(url) %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
score <- c()  ; review <- c()  ; writer <- c()  ;  time <- c()
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, index[1]-1)))
print(score)
print(review)
print(writer)
print(time)
}
review = data.frame(score=score, review=review, writer=writer, time=time)
tot_review <- rbind.data.frame(tot_review, review)
}
for (pg in 1:11) {
url <- paste0 (ifr_url, 'page=', page[pg])
print(url)
}
url <- paste0 (ifr_url, '&page=', page[pg])
print(url)
for (pg in 1:11) {
url <- paste0 (ifr_url, '&page=', page[pg])
print(url)
}
print(url)
for (pg in 1:11) {
url <- paste0 (ifr_url, '&page=', page[pg])
print(url)
html2 <- read_html(url) %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
score <- c()  ; review <- c()  ; writer <- c()  ;  time <- c()
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, index[1]-1)))
print(score)
print(review)
print(writer)
print(time)
}
review = data.frame(score=score, review=review, writer=writer, time=time)
tot_review <- rbind.data.frame(tot_review, review)
}
View(tot_review)
ordered <- tot_review %>%
sort(score, decreasing=T)
ordered <- tot_review %>%
sort(score, decreasing=T)
ordered
ordered <- tot_review %>%
arrange(score)
ordered
View(ordered)
ordered <- tot_review %>%
arrange(desc(score))
View(ordered)
ordered$score
ordered$score [1]
order <- c(1:10)
levels(ordered$score) <- order
ordered$scoer[1]
ordered <- tot_review %>%
arrange(desc(score))
View(ordered)
levels(ordered$score)
as.numeric(ordered$score)
ordred$score <- as.numeric(ordered$score)
orderd$score <- as.numeric(ordered$score)
ordered$score <- as.numeric(ordered$score)
ordered
View(ordered)
ordred$score <- factor(ordered$score,
levels = c(1:10))
ordered$score <- factor(ordered$score,
levels = c(1:10))
ordered$score
ordered <- tot_review %>%
arrange(desc(score))
ordered$score
class(ordered$score)
as.numeric.factor <- function(x) {as.numeric(levels(x))[x]}
as.numeric.factor(ordered$score)
class(ordered$score)
levels(ordered$score)
clss(as.numeric.factor(ordered$score))
class(as.numeric.factor(ordered$score))
ordered$score <- as.numeric.factor(ordered$score)
class(ordered$score)
levels(ordered$score)
ordered$score
ordered <- ordered %>%
arrange(desc(score))
View(ordered)
library(rvest)
library(stringr)
library(dplyr)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
url_base <- 'https://movie.naver.com'
start_url <- '/movie/bi/mi/point.nhn?code='
code <- '176040#tab'
(url <- paste0(url_base, start_url, code, encoding="euc-kr"))
html <- read_html(url)
(html %>%
html_node('iframe.ifr') %>%
html_attr('src') -> url2)
ifr_url <- paste0(url_base, url2)
ifr_url
page <- c(1:11)
tot_review <- data.frame()
for (pg in 1:11) {
url <- paste0 (ifr_url, '&page=', page[pg])
print(url)
html2 <- read_html(url) %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
score <- c()  ; review <- c()  ; writer <- c()  ;  time <- c()
for (li in lis) {
score <- c(score, html_node(li, '.star_score') %>% html_text('em') %>% trim())
(tmp <- li %>%
html_node('.score_reple') %>%
html_text ('p')  %>%
trim())
index <- str_locate(tmp, "\r")
(review <- c(review,
str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(writer <- c(writer, str_sub(tmp, 1, index[1]-1)))
tmp <- trim(str_sub(tmp, index[1], -1))
index <- str_locate(tmp, "\r")
(time <- c(time, str_sub(tmp, 1, index[1]-1)))
print(score)
print(review)
print(writer)
print(time)
}
review = data.frame(score=score, review=review, writer=writer, time=time)
tot_review <- rbind.data.frame(tot_review, review)
}
View(tot_review)
class(tot_review$score)
as.numeric.factor <- function(x) {as.numeric(levels(x))[x]}
tot_review$score <- as.numeric.factor(tot_review$score)
class(tot_review$score)
ordered <- tot_review %>%
arrange(desc(score))
View(ordered)
write.csv(ordered, "navermoview.csv")
setwd("D:/Workspace/Class-Projects/과제")
write.csv(ordered, "navermoview.csv")
write.csv(ordered, "navermovie.csv")
load("D:/Workspace/대회/기상청/분석 자료/M85.rda")
load("D:/Workspace/대회/기상청/분석 자료/M85.rda")
View(M86.rda)
View(M86)
View(M85)
str(M85)
source(str(M85), echo=TRUE, max.deparse.length=1e3)
str(M85, list.len=ncol(M85))
